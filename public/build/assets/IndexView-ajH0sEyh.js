import{_ as M,a as be,b as fe,Q as ge,c as z}from"./SearchBar-DJxEruSr.js";import{Q as ve}from"./QBadge-DqKeR-yY.js";import{Q as ye}from"./QPage-BBLQyAC7.js";import{f as v,o as p,i as d,t as n,j as r,c as S,w as a,b as e,a as R,d as w,Q as P,e as we,k as $e,ad as O,ae as X,v as k,a6 as Y,af as q,ag as T,ah as j,aj as E,a0 as he,x as K,U as Ve,E as ke}from"./app-CVo2F_W3.js";import{_ as Ce}from"./PageHeader-CeaXU9p-.js";import{u as xe}from"./useResourceIndex-OJHyqOIO.js";import{u as Ue,C as W}from"./ConfirmationModal-C_oO7QLW.js";import{u as G,_ as Z}from"./FormModal-3_KjRAQA.js";import{u as ee}from"./useTextTruncate-BXow-7eB.js";import{b as Qe,Q as C,a as x,h as $}from"./QMenu-Bv4-7jnn.js";import{Q as ze,C as F}from"./ClosePopup-CbTDksMi.js";import{Q as ae}from"./QForm-BsOaUD0C.js";import{u as Se}from"./usePollingInterval-ClLiuZEZ.js";import{u as qe}from"./index-DZucgB02.js";import"./QSelect-BsTDJULy.js";import"./format-BOf40pHW.js";import"./QDrawer-BZwB_FoC.js";/* empty css               */import"./useFetch-CRpE6LrY.js";import"./QSpace-92-bbKT5.js";import"./QInnerLoading-CiQDGj4V.js";const Ae={key:0},De=["title"],Ie=["title"],Me={key:1},Pe={key:1},Te={__name:"SecurityGroupColumn",props:{row:{type:Object,required:!0}},setup(i){const{truncate:_}=ee();return(c,y)=>i.row.security_group?(p(),v("div",Ae,[d("div",{title:i.row.security_group.group_id},n(r(_)(i.row.security_group.group_id,15)),9,De),d("div",null,[y[0]||(y[0]=d("span",{class:"font-medium me-2 text-gray-600 dark:text-gray-400"},"VPC:",-1)),i.row.security_group.vpc_id?(p(),v("span",{key:0,title:i.row.security_group.vpc_id},n(r(_)(i.row.security_group.vpc_id,10)),9,Ie)):(p(),v("span",Me,"N/A"))])])):(p(),v("div",Pe,[...y[1]||(y[1]=[d("div",null,"N/A",-1)])]))}},je=["title"],Ne={key:1,class:"text-xs"},Be={class:"font-medium me-1 text-gray-600 dark:text-gray-400"},Re=["title"],Fe={__name:"DBNameColumn",props:{row:{type:Object,required:!0}},setup(i){const{truncate:_}=ee();return(c,y)=>(p(),v("div",null,[d("div",null,[i.row.db_name?(p(),v("span",{key:0,title:i.row.db_name},n(r(_)(i.row.db_name,10)),9,je)):(p(),v("span",Ne,"N/A"))]),d("div",null,[d("span",Be,n(c.$t("databases.DII"))+": ",1),d("span",{title:i.row.db_instance_identifier},n(r(_)(i.row.db_instance_identifier,10)),9,Re)])]))}},Le=["title"],Oe={class:"font-medium me-1 text-gray-600 dark:text-gray-400"},Ee={key:0},Ge={key:1,class:"text-xs"},He={__name:"EngineColumn",props:{row:{type:Object,required:!0}},setup(i){return(_,c)=>(p(),v("div",null,[d("div",null,[d("span",{title:i.row.engine.description},n(i.row.engine.label),9,Le)]),d("div",null,[d("span",Oe,n(_.$t("databases.version"))+": ",1),i.row.engine_version?(p(),v("span",Ee,n(i.row.engine_version),1)):(p(),v("span",Ge,"N/A"))])]))}},Je=["title"],Ke={class:"font-medium me-1 text-gray-600 dark:text-gray-400"},We={class:"font-medium me-1 text-gray-600 dark:text-gray-400"},Xe={key:0},Ye={key:1},Ze={__name:"StorageColumn",props:{row:{type:Object,required:!0}},setup(i){return(_,c)=>(p(),v("div",null,[d("div",null,[d("span",{title:i.row.storage_type.description},n(i.row.storage_type.value),9,Je)]),d("div",null,[d("span",Ke,n(_.$t("databases.size"))+": ",1),d("span",null,n(i.row.allocated_storage),1)]),d("div",null,[d("span",We,n(_.$t("databases.encryption"))+": ",1),i.row.storage_encrypted?(p(),v("span",Xe,n(_.$t("active")),1)):(p(),v("span",Ye,n(_.$t("inactive")),1))])]))}},ea={__name:"ActionsColumn",props:{row:{type:Object,required:!0}},emits:["delete","attach","create-snapshot"],setup(i,{emit:_}){const c=_,y=g=>{c("delete",g)},l=g=>{c("attach",g)},f=g=>{c("create-snapshot",g)};return(g,h)=>(p(),S($e,{icon:"sym_r_more_horiz",padding:"xs",size:"sm",unelevated:""},{default:a(()=>[e(Qe,{offset:[15,6],"transition-show":"jump-down","transition-hide":"jump-up",class:"q-pa-xs rounded-lg dark:bg-slate-700 shadow-lg border dark:border-none min-w-48"},{default:a(()=>[e(ze,{style:{"min-width":"100px"},dense:"",class:"q-pa-xs"},{default:a(()=>[R((p(),S(C,{to:{name:"databases.show",params:{id:i.row.id}},clickable:"",class:"text-gray-600 dark:text-gray-200 rounded-md"},{default:a(()=>[e(x,null,{default:a(()=>[e($,{class:"flex-nowrap"},{default:a(()=>[e(P,{name:"sym_r_visibility",size:"xs",class:"me-1"}),w(" "+n(g.$t("view_details")),1)]),_:1})]),_:1})]),_:1},8,["to"])),[[F]]),R((p(),S(C,{clickable:"",class:"text-gray-600 dark:text-gray-200 rounded-md",onClick:h[0]||(h[0]=u=>l(i.row))},{default:a(()=>[e(x,null,{default:a(()=>[e($,{class:"flex-nowrap"},{default:a(()=>[e(P,{name:"sym_r_link",size:"xs",class:"me-1"}),w(" "+n(g.$t("attach_to_server")),1)]),_:1})]),_:1})]),_:1})),[[F]]),R((p(),S(C,{clickable:"",class:"text-gray-600 dark:text-gray-200 rounded-md",onClick:h[1]||(h[1]=u=>f(i.row))},{default:a(()=>[e(x,null,{default:a(()=>[e($,{class:"flex-nowrap"},{default:a(()=>[e(P,{name:"sym_r_backup",size:"xs",class:"me-1"}),w(" "+n(g.$t("databases.create_snapshot")),1)]),_:1})]),_:1})]),_:1})),[[F]]),e(we,{class:"q-my-xs"}),R((p(),S(C,{onClick:h[2]||(h[2]=u=>y(i.row)),clickable:"",class:"text-red-600 dark:text-red-400 rounded-md"},{default:a(()=>[e(x,null,{default:a(()=>[e($,{class:"flex-nowrap"},{default:a(()=>[e(P,{name:"sym_r_delete",size:"xs",class:"me-1"}),w(" "+n(g.$t("delete")),1)]),_:1})]),_:1})]),_:1})),[[F]])]),_:1})]),_:1})]),_:1}))}},aa={class:"grid grid-cols-1 md:grid-cols-2 md:gap-3 space-y-3 md:space-y-0"},ta={class:"grid grid-cols-1 md:grid-cols-2 md:gap-3 space-y-3 md:space-y-0"},sa={class:"grid grid-cols-1 md:grid-cols-2 md:gap-3 space-y-3 md:space-y-0"},la={class:"grid grid-cols-1 md:grid-cols-2 md:gap-3 space-y-3 md:space-y-0"},oa={class:"grid grid-cols-1 md:grid-cols-2 md:gap-3 space-y-3 md:space-y-0"},ra={class:"grid grid-cols-1 md:grid-cols-2 md:gap-3 space-y-3 md:space-y-0"},na={__name:"CreateForm",props:{open:{},openModifiers:{}},emits:O(["created"],["update:open"]),setup(i,{emit:_}){const c=X(i,"open"),y=_,l=k({multi_az:!1,storage_encrypted:!1}),f=k(!0),{create:g,creating:h,validation:u}=G("rds-databases"),A=async()=>{await g(l.value),Q(),y("created")},Q=()=>{l.value={multi_az:!1,publicly_accessible:!1,storage_encrypted:!1},u.value={},c.value=!1};return(m,s)=>(p(),S(Z,{open:c.value,"onUpdate:open":s[13]||(s[13]=t=>c.value=t),title:"databases.create",form:"databases-form",onClose:Q,loading:r(h)},{form:a(()=>[e(ae,{id:"databases-form",onSubmit:Y(A,["prevent","self"]),class:"q-gutter-md"},{default:a(()=>[d("div",aa,[e(q,{modelValue:l.value.db_instance_identifier,"onUpdate:modelValue":s[0]||(s[0]=t=>l.value.db_instance_identifier=t),label:m.$t("databases.db_instance_identifier")+"*","error-message":r(u).db_instance_identifier?.[0],error:"db_instance_identifier"in r(u),minlength:"1",maxlength:"63",dense:"",outlined:"","hide-bottom-space":"",hint:m.$t("databases.instance_id_details")+". e.g., my-database-1"},null,8,["modelValue","label","error-message","error","hint"]),e(q,{dense:"",modelValue:l.value.db_name,"onUpdate:modelValue":s[1]||(s[1]=t=>l.value.db_name=t),label:m.$t("databases.db_name")+"*","error-message":r(u).db_name?.[0],error:"db_name"in r(u),outlined:"","hide-bottom-space":""},null,8,["modelValue","label","error-message","error"])]),d("div",ta,[e(M,{modelValue:l.value.engine,"onUpdate:modelValue":s[2]||(s[2]=t=>l.value.engine=t),label:m.$t("databases.engine")+"*",resource:"rds-databases/engines","option-label":"label","error-message":r(u).engine?.[0],error:"engine"in r(u),outlined:"","hide-bottom-space":""},{option:a(t=>[e(C,T(j(t.itemProps)),{default:a(()=>[e(x,null,{default:a(()=>[e($,null,{default:a(()=>[w(n(t.opt.label),1)]),_:2},1024),e($,{caption:""},{default:a(()=>[w(n(t.opt.description),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","label","error-message","error"]),e(M,{modelValue:l.value.vpc_security_group,"onUpdate:modelValue":s[3]||(s[3]=t=>l.value.vpc_security_group=t),label:m.$t("security_groups.title")+"*",resource:"security-groups","option-label":"name","error-message":r(u).vpc_security_group?.[0],error:"vpc_security_group"in r(u),outlined:"","hide-bottom-space":""},{option:a(t=>[e(C,T(j(t.itemProps)),{default:a(()=>[e(x,null,{default:a(()=>[e($,null,{default:a(()=>[w(n(t.opt.name),1)]),_:2},1024),e($,{caption:""},{default:a(()=>[w(n(t.opt.group_id),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","label","error-message","error"])]),d("div",sa,[e(M,{modelValue:l.value.storage_type,"onUpdate:modelValue":s[4]||(s[4]=t=>l.value.storage_type=t),label:m.$t("databases.storage_type")+"*",resource:"rds-databases/storage-types","option-label":"value","option-value":"value","error-message":r(u).storage_type?.[0],error:"storage_type"in r(u),outlined:"","hide-bottom-space":""},{option:a(t=>[e(C,T(j(t.itemProps)),{default:a(()=>[e(x,null,{default:a(()=>[e($,null,{default:a(()=>[w(n(t.opt.value),1)]),_:2},1024),e($,{caption:""},{default:a(()=>[w(n(t.opt.description),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","label","error-message","error"]),e(M,{modelValue:l.value.db_instance_class,"onUpdate:modelValue":s[5]||(s[5]=t=>l.value.db_instance_class=t),label:m.$t("databases.db_instance_class")+"*",resource:"rds-databases/instance-classes","option-label":"value","error-message":r(u).db_instance_class?.[0],error:"db_instance_class"in r(u),outlined:"","hide-bottom-space":""},{option:a(t=>[e(C,T(j(t.itemProps)),{default:a(()=>[e(x,null,{default:a(()=>[e($,null,{default:a(()=>[w(n(t.opt.value),1)]),_:2},1024),e($,{caption:""},{default:a(()=>[w(n(t.opt.description),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","label","error-message","error"])]),d("div",la,[e(q,{dense:"",modelValue:l.value.master_username,"onUpdate:modelValue":s[6]||(s[6]=t=>l.value.master_username=t),label:m.$t("databases.master_username")+"*","error-message":r(u).master_username?.[0],error:"master_username"in r(u),outlined:"","hide-bottom-space":"",hint:m.$t("databases.master_username_details")},null,8,["modelValue","label","error-message","error","hint"]),e(q,{dense:"",modelValue:l.value.master_password,"onUpdate:modelValue":s[8]||(s[8]=t=>l.value.master_password=t),label:m.$t("databases.master_password")+"*","error-message":r(u).master_password?.[0],error:"master_password"in r(u),outlined:"","hide-bottom-space":"",type:f.value?"password":"text",hint:m.$t("databases.master_password_security_hint")},{append:a(()=>[e(P,{name:f.value?"visibility_off":"visibility",class:"cursor-pointer",size:"xs",onClick:s[7]||(s[7]=t=>f.value=!f.value)},null,8,["name"])]),_:1},8,["modelValue","label","error-message","error","type","hint"])]),d("div",oa,[e(q,{type:"number",modelValue:l.value.allocated_storage,"onUpdate:modelValue":s[9]||(s[9]=t=>l.value.allocated_storage=t),label:m.$t("databases.allocated_storage")+"*","error-message":r(u).allocated_storage?.[0],error:"allocated_storage"in r(u),min:"20",dense:"",outlined:"","hide-bottom-space":"",hint:m.$t("databases.allocated_storage_hint")},null,8,["modelValue","label","error-message","error","hint"]),e(q,{modelValue:l.value.backup_retention_period,"onUpdate:modelValue":s[10]||(s[10]=t=>l.value.backup_retention_period=t),label:m.$t("databases.backup_retention_period"),"error-message":r(u).backup_retention_period?.[0],error:"backup_retention_period"in r(u),dense:"",outlined:"","hide-bottom-space":"",type:"number",max:"35",min:"0",hint:m.$t("databases.backup_retention_period_hint")},null,8,["modelValue","label","error-message","error","hint"])]),d("div",ra,[e(E,{modelValue:l.value.multi_az,"onUpdate:modelValue":s[11]||(s[11]=t=>l.value.multi_az=t),label:m.$t("databases.multi_az"),color:"primary",class:"q-mt-sm flex gap-1"},null,8,["modelValue","label"]),e(E,{modelValue:l.value.storage_encrypted,"onUpdate:modelValue":s[12]||(s[12]=t=>l.value.storage_encrypted=t),label:m.$t("databases.encryption"),color:"primary",class:"q-mt-sm flex gap-1"},null,8,["modelValue","label"])])]),_:1})]),_:1},8,["open","loading"]))}},ia={class:"text-xs text-gray-600 dark:text-gray-400"},da={__name:"AttachToServerForm",props:O({id:{type:[String,Number]}},{open:{},openModifiers:{}}),emits:O(["attached"],["update:open"]),setup(i,{emit:_}){const c=i,y=X(i,"open"),l=_,f=k({is_primary:!1}),{create:g,creating:h,validation:u}=G("rds-databases/attachments"),A=async()=>{f.value.rds_database_id=c.id,await g(f.value),Q(),l("attached")},Q=()=>{u.value={},f.value={is_primary:!1},y.value=!1};return(m,s)=>(p(),v("template",null,[e(Z,{open:y.value,"onUpdate:open":s[2]||(s[2]=t=>y.value=t),title:"attach_to_server",form:"databases-attach-form",onClose:Q,loading:r(h)},{form:a(()=>[e(ae,{id:"databases-attach-form",onSubmit:Y(A,["prevent","self"]),class:"q-gutter-md"},{default:a(()=>[e(M,{modelValue:f.value.server,"onUpdate:modelValue":s[0]||(s[0]=t=>f.value.server=t),label:m.$t("databases.server")+"*",resource:"rds-databases/servers","option-label":"name","error-message":r(u).server_id?.[0],error:"server_id"in r(u),outlined:"","hide-bottom-space":""},{option:a(t=>[e(C,T(j(t.itemProps)),{default:a(()=>[e(x,null,{default:a(()=>[e($,null,{default:a(()=>[w(n(t.opt.name),1)]),_:2},1024),e($,{caption:""},{default:a(()=>[w(n(t.opt.instance_id),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","label","error-message","error"]),e(E,{modelValue:f.value.is_primary,"onUpdate:modelValue":s[1]||(s[1]=t=>f.value.is_primary=t),label:m.$t("databases.primary"),"error-message":r(u).is_primary?.[0],error:"is_primary"in r(u),"hide-bottom-space":"",class:"mt-4 flex gap-1"},null,8,["modelValue","label","error-message","error"]),d("div",ia,n(m.$t("databases.primary_note")),1)]),_:1})]),_:1},8,["open","loading"])]))}},ua={class:"mt-4 bg-white dark:bg-slate-800 p-3 rounded-md"},ma={class:"flex items-center justify-between gap-3 mb-3"},pa={key:0},ca={key:1,class:"text-xs"},_a={class:"mt-2 ms-2 text-xs text-gray-500 dark:text-gray-400"},ba={class:"font-medium"},fa={class:"list-disc ms-4 mt-1"},ja={__name:"IndexView",setup(i){const{data:_,fetch:c,loading:y,options:l,onRequest:f}=xe("rds-databases"),{destroy:g,destroyed:h,destroying:u}=Ue("rds-databases"),{create:A,creating:Q,validation:m}=G("rds-database-snapshots"),{t:s}=he(),{start:t,stop:te}=Se(()=>{c({filter:U.value,filters:l.filters})},2e4),se=K(()=>[{name:"id",label:s("id"),field:"id",sortable:!0,align:"left"},{name:"db_name",label:s("name"),field:"db_name",align:"left"},{name:"engine",label:s("databases.engine"),field:"engine",align:"left"},{name:"storage_type",label:s("databases.storage"),field:"storage_type",align:"left"},{name:"security_group",label:s("databases.security_group"),field:"security_group",align:"left"},{name:"availability_zone",label:s("databases.availability_zone"),field:"availability_zone",align:"left"},{name:"status",label:s("status"),field:"status",align:"left"},{name:"created_at",label:s("creation_details"),sortable:!0,field:"created_at",align:"left"},{name:"actions",label:s("actions"),field:"actions",align:"center"}]),le=K(()=>[{name:"created_at",label:s("creation_date"),type:"date"}]),U=k(""),N=k(!1),D=k(!1),B=k(!1),I=k(!1),H=k(null),J=k(null),L=k(null),oe=({search:V,filters:b})=>{c({search:V,filters:b})},re=()=>{f({filter:U.value})},ne=()=>{N.value=!0},ie=()=>{N.value=!1,c({filter:U.value,filters:l.filters})},de=V=>{H.value=V,D.value=!0},ue=async()=>{await g(H.value.id),h.value&&(D.value=!1,c({filter:U.value,filters:l.filters}))},me=V=>{J.value=V,B.value=!0},pe=()=>{B.value=!1,c({filter:U.value,filters:l.filters})},ce=V=>{L.value=V,I.value=!0},_e=async()=>{await A({rds_database_id:L.value.id,db_instance_identifier:L.value.db_instance_identifier}),m.value?.errors||(I.value=!1,c({filter:U.value,filters:l.filters}))};return Ve(()=>{qe(t,3e3)()}),ke(()=>{te()}),(V,b)=>(p(),S(ye,{class:"q-pa-md"},{default:a(()=>[e(na,{open:N.value,"onUpdate:open":b[0]||(b[0]=o=>N.value=o),onCreated:ie},null,8,["open"]),e(da,{open:B.value,"onUpdate:open":b[1]||(b[1]=o=>B.value=o),id:J.value?.id,onAttached:pe},null,8,["open","id"]),e(W,{open:D.value,"onUpdate:open":b[2]||(b[2]=o=>D.value=o),title:"databases.delete",icon:"warning",color:"negative",loading:r(u),onConfirm:ue,onCancel:b[3]||(b[3]=o=>D.value=!1)},null,8,["open","loading"]),e(W,{open:I.value,"onUpdate:open":b[4]||(b[4]=o=>I.value=o),title:"databases.create_snapshot_modal_title",icon:"info",color:"primary",loading:r(Q),actionLabel:V.$t("databases.create_snapshot"),onConfirm:_e,onCancel:b[5]||(b[5]=o=>I.value=!1)},null,8,["open","loading","actionLabel"]),e(Ce,{title:"databases.title",subtitle:"databases.subtitle",icon:"sym_r_database",actionLabel:"databases.create",actionIcon:"add",action:ne}),d("div",ua,[d("div",ma,[e(be,{onSearch:re,searchValue:U.value,"onUpdate:searchValue":b[6]||(b[6]=o=>U.value=o),class:"md:max-w-sm max-w-full"},null,8,["searchValue"]),e(fe,{filters:le.value,onUpdate:oe},null,8,["filters"])]),e(ge,{columns:se.value,rows:r(_)??[],loading:r(y),pagination:r(l).pagination,"onUpdate:pagination":b[7]||(b[7]=o=>r(l).pagination=o),onRequest:r(f),flat:"","rows-per-page-options":[5,10,20,30,40,50,100]},{"body-cell-db_name":a(o=>[e(z,{props:o},{default:a(()=>[e(Fe,{row:o.row},null,8,["row"])]),_:2},1032,["props"])]),"body-cell-engine":a(o=>[e(z,{props:o},{default:a(()=>[e(He,{row:o.row},null,8,["row"])]),_:2},1032,["props"])]),"body-cell-storage_type":a(o=>[e(z,{props:o},{default:a(()=>[e(Ze,{row:o.row},null,8,["row"])]),_:2},1032,["props"])]),"body-cell-security_group":a(o=>[e(z,{props:o},{default:a(()=>[e(Te,{row:o.row},null,8,["row"])]),_:2},1032,["props"])]),"body-cell-status":a(o=>[e(z,{props:o,title:o.row.status.label},{default:a(()=>[e(ve,{"text-color":o.row.status.color,size:"xs",class:"w-fit"},{default:a(()=>[w(n(o.row.status.label),1)]),_:2},1032,["text-color"])]),_:2},1032,["props","title"])]),"body-cell-availability_zone":a(o=>[e(z,{props:o},{default:a(()=>[o.row.availability_zone?(p(),v("div",pa,n(o.row.availability_zone),1)):(p(),v("div",ca,"N/A"))]),_:2},1032,["props"])]),"body-cell-actions":a(o=>[e(z,{props:o},{default:a(()=>[e(ea,{row:o.row,onDelete:de,onAttach:me,onCreateSnapshot:ce},null,8,["row"])]),_:2},1032,["props"])]),_:1},8,["columns","rows","loading","pagination","onRequest"])]),d("div",_a,[d("span",ba,n(V.$t("note"))+":",1),d("ul",fa,[d("li",null,n(V.$t("databases.instance_id_details"))+".",1),d("li",null,n(V.$t("not_available_meaning")),1)])])]),_:1}))}};export{ja as default};
