import{c as p,o as l,w as i,b as s,ak as O,a6 as E,k as F,al as G,a1 as A,g as u,i as t,Q as k,t as e,f as d,a3 as N,a4 as D,l as Q,a as J,d as $,am as K,a0 as W,j as a,v as b,U as X,ai as Y}from"./app-CVo2F_W3.js";import{Q as S}from"./QBadge-DqKeR-yY.js";import{Q as M,a as T}from"./QInnerLoading-CiQDGj4V.js";import{Q as Z}from"./QPage-BBLQyAC7.js";import{u as tt}from"./useResourceShow-DPDX-8vq.js";import{u as et,C as I}from"./ConfirmationModal-C_oO7QLW.js";import{u as st}from"./useResourceUpdate-a58ld08K.js";import{u as at}from"./useTextTruncate-BXow-7eB.js";import{b as it,Q as ot,a as lt,h as nt}from"./QMenu-Bv4-7jnn.js";import{_ as L}from"./WarningAlert-Dvx9fMIH.js";import{Q as dt}from"./ClosePopup-CbTDksMi.js";import{u as rt}from"./index-CwMOWcUW.js";/* empty css               */import"./useFetch-CRpE6LrY.js";import"./index-DZucgB02.js";const ct={__name:"ActionsDropdown",props:{transitionShow:{type:String,default:"jump-down"},transitionHide:{type:String,default:"jump-up"},offset:{type:Array,default:()=>[15,6]},icon:{type:String,default:"sym_r_more_horiz"}},setup(r){return(o,_)=>(l(),p(F,{onClick:_[0]||(_[0]=E(()=>{},["stop"])),icon:r.icon,padding:"xs",size:"sm",unelevated:""},{default:i(()=>[s(it,{offset:r.offset,"transition-show":r.transitionShow,"transition-hide":r.transitionHide,class:"q-pa-xs rounded-lg dark:bg-slate-700 shadow-lg border dark:border-none min-w-48"},{default:i(()=>[s(dt,{style:{"min-width":"100px"},dense:"",class:"q-pa-xs"},{default:i(()=>[O(o.$slots,"items")]),_:3})]),_:3},8,["offset","transition-show","transition-hide"])]),_:3},8,["icon"]))}},ut={class:"font-meduim text-lg"},_t={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 justify-between items-center"},mt={class:"p-2 w-fit rounded-md bg-primary-50"},pt={class:"flex items-center justify-between"},gt={key:0,class:"text-sm font-medium"},yt={key:1,class:"text-sm font-medium"},ft={class:"flex flex-nowrap items-center justify-betweeen"},vt={class:"flex flex-nowrap gap-2 items-center mt-1"},xt={class:"w-fit"},ht={key:0,class:"w-fit"},bt={__name:"AttachedServersCard",props:{servers:{type:Array,required:!0},loading:{type:Boolean,default:!1}},emits:["update","delete"],setup(r,{emit:o}){const _=o,v=G(),x=[{label:"view_details",action:c=>{v.push({name:"servers.show",params:{id:c.id}})},icon:"sym_r_visibility",type:"view"},{label:"databases.make_primary",action:c=>_("update",c.pivot,c),icon:"sym_r_edit",type:"edit"},{label:"databases.delete_association",action:c=>_("delete",c.pivot),icon:"sym_r_link_off",type:"delete"}];return(c,g)=>(l(),p(Q,{class:"p-4"},{default:i(()=>[s(u,{class:"p-0 flex items-center gap-2 pb-0"},{default:i(()=>[s(k,{name:"sym_r_link",color:"primary",size:"sm"}),t("h4",ut,e(c.$t("databases.attached_servers")),1)]),_:1}),r.servers&&r.servers.length?(l(),p(u,{key:0},{default:i(()=>[t("div",_t,[(l(!0),d(N,null,D(r.servers,m=>(l(),p(Q,{key:m.id,class:"w-full flex flex-nowrap gap-3 items-center p-3 border mt-3"},{default:i(()=>[s(u,{class:"p-0"},{default:i(()=>[t("div",mt,[s(k,{name:"sym_r_host",size:"sm",class:"text-primary"})])]),_:1}),s(u,{class:"p-0 flex-1"},{default:i(()=>[t("div",pt,[m.instance_id&&m.instance_id!==null?(l(),d("div",gt,e(m.instance_id)+" - "+e(m.name),1)):(l(),d("div",yt," N/A ")),s(ct,null,{items:i(()=>[(l(),d(N,null,D(x,(f,C)=>J(s(ot,{key:C,to:f.link?f.link:null,clickable:"",class:"text-gray-600 dark:text-gray-200 rounded-md text-sm",onClick:h=>f.action(m)},{default:i(()=>[s(lt,null,{default:i(()=>[s(nt,{class:"flex-nowrap"},{default:i(()=>[s(k,{name:f.icon,size:"xs",class:"me-1"},null,8,["name"]),$(" "+e(c.$t(f.label)),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["to","onClick"]),[[K,f.type!=="edit"||f.type==="edit"&&!m.pivot?.is_primary]])),64))]),_:2},1024)]),t("div",ft,[t("div",vt,[t("div",xt,[s(S,{"text-color":m.status.color,size:"xs",class:"q-mt-xs"},{default:i(()=>[$(e(m.status.label),1)]),_:2},1032,["text-color"])]),m.pivot?.is_primary?(l(),d("div",ht,[s(S,{"text-color":"primary",size:"xs",class:"q-mt-xs"},{default:i(()=>[$(e(c.$t("databases.primary")),1)]),_:1})])):A("",!0)])])]),_:2},1024)]),_:2},1024))),128))])]),_:1})):(l(),p(u,{key:1,class:"pt-3 px-2"},{default:i(()=>[s(L,{message:"no_data_available_msg"})]),_:1})),r.loading?(l(),p(u,{key:2,class:"p-0"},{default:i(()=>[s(M,{showing:r.loading,class:"rounded-lg"},{default:i(()=>[s(T,{color:"primary",size:"40px"})]),_:1},8,["showing"])]),_:1})):A("",!0)]),_:1}))}},kt={class:"font-meduim text-lg"},$t={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 justify-between items-center"},wt={class:"p-2 w-fit rounded-md bg-primary-50"},qt={class:"flex items-center justify-between"},zt={class:"text-sm font-medium"},Qt={class:"flex flex-nowrap items-center gap-1 text-xs text-gray-500 dark:text-gray-400 mt-1"},Ct={key:0},St={key:1},At={class:"w-fit mt-1"},Nt={__name:"LatestSnapshotsCard",props:{snapshots:{type:Array,required:!0},loading:{type:Boolean,default:!1}},emits:["update","delete"],setup(r,{emit:o}){const{t:_}=W(),v=rt(x=>{switch(x){case"automatic":return _("databases.automatic_snapshot");case"manual":return _("databases.manual_snapshot");default:return"N/A"}});return(x,c)=>(l(),p(Q,{class:"p-4"},{default:i(()=>[s(u,{class:"p-0 flex items-center gap-2 pb-0"},{default:i(()=>[s(k,{name:"sym_r_backup",color:"primary",size:"sm"}),t("h4",kt,e(x.$t("databases.latest_snapshots")),1)]),_:1}),r.snapshots&&r.snapshots.length?(l(),p(u,{key:0},{default:i(()=>[t("div",$t,[(l(!0),d(N,null,D(r.snapshots,g=>(l(),p(Q,{key:g.id,class:"w-full flex flex-nowrap gap-3 items-center p-3 border mt-3"},{default:i(()=>[s(u,{class:"p-0"},{default:i(()=>[t("div",wt,[s(k,{name:"sym_r_backup",size:"md",class:"text-primary"})])]),_:1}),s(u,{class:"p-0 flex-1"},{default:i(()=>[t("div",qt,[t("div",zt,e(g.snapshot_identifier),1)]),t("div",Qt,[g.snapshot_type?(l(),d("div",Ct,e(a(v)(g.snapshot_type)),1)):(l(),d("div",St,"N/A")),c[0]||(c[0]=$(" | ",-1)),t("div",null,e(g.created_at),1)]),t("div",At,[s(S,{"text-color":g.status.color,size:"xs",class:"q-mt-xs"},{default:i(()=>[$(e(g.status.label),1)]),_:2},1032,["text-color"])])]),_:2},1024)]),_:2},1024))),128))])]),_:1})):(l(),p(u,{key:1,class:"pt-4 px-2"},{default:i(()=>[s(L,{message:"no_data_available_msg"})]),_:1})),r.loading?(l(),p(u,{key:2,class:"p-0"},{default:i(()=>[s(M,{showing:r.loading,class:"rounded-lg"},{default:i(()=>[s(T,{color:"primary",size:"40px"})]),_:1},8,["showing"])]),_:1})):A("",!0)]),_:1}))}},Dt={class:"font-meduim text-lg"},Mt={class:"q-gutter-xs pb-3 text-sm"},Tt={class:"text-gray-600 dark:text-gray-400"},Ut={class:"q-gutter-xs pb-3 text-sm"},jt={class:"text-gray-600 dark:text-gray-400"},Bt={class:"q-gutter-xs pb-3 text-sm"},It={class:"text-gray-600 dark:text-gray-400"},Lt={class:"q-gutter-xs pb-3 text-sm"},Pt={key:0,class:"text-gray-600 dark:text-gray-400"},Rt={key:1,class:"text-gray-600 dark:text-gray-400"},Vt={class:"q-gutter-xs pb-3 text-sm"},Ht={class:"text-gray-600 dark:text-gray-400"},Ot={class:"q-gutter-xs pb-3 text-sm"},Et={class:"text-gray-600 dark:text-gray-400"},Ft={class:"q-gutter-xs pb-3 text-sm"},Gt={class:"text-gray-600 dark:text-gray-400"},Jt={class:"q-gutter-xs pb-3 text-sm"},Kt={class:"text-gray-600 dark:text-gray-400"},Wt={class:"q-gutter-xs pb-3 text-sm"},Xt=["title"],Yt={key:1,class:"text-gray-600 dark:text-gray-400"},Zt={class:"q-gutter-xs pb-3 text-sm"},te={class:"text-gray-600 dark:text-gray-400"},ee={class:"q-gutter-xs pb-3 text-sm"},se={class:"text-gray-600 dark:text-gray-400"},ae={class:"q-gutter-xs pb-3 text-sm"},ie={class:"q-gutter-xs pb-3 text-sm"},oe=["title"],le={key:1,class:"text-gray-600 dark:text-gray-400"},ne={class:"q-gutter-xs pb-3 text-sm"},de={key:0,class:"text-gray-600 dark:text-gray-400"},re={key:1,class:"text-gray-600 dark:text-gray-400"},ce={class:"q-gutter-xs pb-3 text-sm"},ue={key:0,class:"text-gray-600 dark:text-gray-400"},_e={key:1,class:"text-gray-600 dark:text-gray-400"},me={class:"q-gutter-xs pb-3 text-sm"},pe=["title"],Ae={__name:"ShowDetailsView",setup(r){const{data:o,fetch:_,loading:v}=tt("rds-databases"),{destroy:x,destroying:c}=et("rds-databases/attachments"),{update:g,updating:m}=st("rds-databases/attachments",{config:{method:"PATCH"}}),f=Y(),{truncate:C}=at(),h=b(null),w=b(!1),q=b(!1),U=b(null),j=b(null),B=b(null),P=n=>{U.value=n,w.value=!0},R=(n,y)=>{j.value=n,B.value=y,q.value=!0},V=async()=>{await x(U.value.id),w.value=!1,_(h.value)},H=async()=>{await g(j.value.id,{is_primary:!0,server:B.value}),q.value=!1,_(h.value)};return X(()=>{h.value=f.params.id,h.value&&_(h.value)}),(n,y)=>(l(),p(Z,{class:"q-pa-md"},{default:i(()=>[s(I,{open:w.value,"onUpdate:open":y[0]||(y[0]=z=>w.value=z),title:"databases.delete_association",icon:"warning",color:"negative",loading:a(c),onConfirm:V,onCancel:y[1]||(y[1]=z=>w.value=!1)},null,8,["open","loading"]),s(I,{open:q.value,"onUpdate:open":y[2]||(y[2]=z=>q.value=z),title:"databases.make_primary",icon:"info",color:"primary",loading:a(m),actionLabel:n.$t("databases.make_primary"),onConfirm:H,onCancel:y[3]||(y[3]=z=>q.value=!1)},null,8,["open","loading","actionLabel"]),s(Q,{class:"p-4"},{default:i(()=>[s(u,{class:"p-0 flex items-center gap-2 pb-4"},{default:i(()=>[s(k,{name:"sym_r_database",color:"primary",size:"sm"}),t("h4",Dt,e(n.$t("databases.database_details")),1)]),_:1}),s(u,{class:"grid grid-cols-1 sm:grid-cols-2 gap-y-2 sm:gap-y-0 p-0"},{default:i(()=>[t("div",Mt,[t("div",null,e(n.$t("databases.db_instance_identifier")),1),t("div",Tt,e(a(o)?.db_instance_identifier),1)]),t("div",Ut,[t("div",null,e(n.$t("name")),1),t("div",jt,e(a(o)?.db_name),1)]),t("div",Bt,[t("div",null,e(n.$t("databases.engine")),1),t("div",It,e(a(o)?.engine?.label),1)]),t("div",Lt,[t("div",null,e(n.$t("databases.engine_version")),1),a(o)?.engine_version?(l(),d("div",Pt,e(a(o)?.engine_version),1)):(l(),d("div",Rt," N/A "))]),t("div",Vt,[t("div",null,e(n.$t("databases.db_instance_class")),1),t("div",Ht,e(a(o)?.db_instance_class?.value),1)]),t("div",Ot,[t("div",null,e(n.$t("databases.storage_type")),1),t("div",Et,e(a(o)?.storage_type?.value),1)]),t("div",Ft,[t("div",null,e(n.$t("databases.allocated_storage")),1),t("div",Gt,e(a(o)?.allocated_storage),1)]),t("div",Jt,[t("div",null,e(n.$t("databases.encryption")),1),t("div",Kt,e(a(o)?.storage_encrypted?n.$t("active"):n.$t("inactive")),1)]),t("div",Wt,[t("div",null,e(n.$t("databases.availability_zone")),1),a(o)?.availability_zone?(l(),d("div",{key:0,class:"text-gray-600 dark:text-gray-400",title:a(o)?.availability_zone},e(a(C)(a(o)?.availability_zone,55)),9,Xt)):(l(),d("div",Yt," N/A "))]),t("div",Zt,[t("div",null,e(n.$t("databases.publicly_accessible")),1),t("div",te,e(a(o)?.publicly_accessible?n.$t("active"):n.$t("inactive")),1)]),t("div",ee,[t("div",null,e(n.$t("databases.multi_az")),1),t("div",se,e(a(o)?.multi_az?n.$t("active"):n.$t("inactive")),1)]),t("div",ae,[t("div",null,e(n.$t("status")),1),s(S,{"text-color":a(o)?.status?.color,size:"xs",class:"w-fit"},{default:i(()=>[$(e(a(o)?.status?.label),1)]),_:1},8,["text-color"])]),t("div",ie,[t("div",null,e(n.$t("databases.endpoint_address")),1),a(o)?.endpoint_address?(l(),d("div",{key:0,class:"text-gray-600 dark:text-gray-400",title:a(o)?.endpoint_address},e(a(C)(a(o)?.endpoint_address,55)),9,oe)):(l(),d("div",le," N/A "))]),t("div",ne,[t("div",null,e(n.$t("databases.endpoint_port")),1),a(o)?.endpoint_port?(l(),d("div",de,e(a(o)?.endpoint_port),1)):(l(),d("div",re," N/A "))]),t("div",ce,[t("div",null,e(n.$t("databases.backup_retention_period")),1),a(o)?.backup_retention_period?(l(),d("div",ue,e(a(o)?.backup_retention_period),1)):(l(),d("div",_e," N/A "))]),t("div",me,[t("div",null,e(n.$t("creation_date")),1),t("div",{class:"text-gray-600 dark:text-gray-400",title:a(o).instance_create_time},e(a(o).created_at),9,pe)])]),_:1}),s(u,{class:"p-0"},{default:i(()=>[s(M,{showing:a(v),class:"rounded-lg"},{default:i(()=>[s(T,{color:"primary",size:"40px"})]),_:1},8,["showing"])]),_:1})]),_:1}),s(bt,{servers:a(o)?.servers||[],loading:a(v),class:"mt-4",onDelete:P,onUpdate:R},null,8,["servers","loading"]),s(Nt,{snapshots:a(o)?.snapshots||[],loading:a(v),class:"mt-4"},null,8,["snapshots","loading"])]),_:1}))}};export{Ae as default};
