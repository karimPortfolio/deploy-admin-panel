import{a as re,b as de,Q as ue,c as L}from"./SearchBar-DJxEruSr.js";import{Q as me}from"./QPage-BBLQyAC7.js";import{c as Q,o as y,w as t,b as e,a as M,d as V,Q as S,t as f,e as I,k as ce,ad as B,ae as O,v as k,f as D,a6 as G,af as H,j as o,D as J,x as E,l as P,g as U,i as u,a1 as pe,a3 as A,a4 as fe,a0 as _e}from"./app-CVo2F_W3.js";import{_ as ye}from"./PageHeader-CeaXU9p-.js";import{u as ve}from"./useResourceIndex-OJHyqOIO.js";import{u as ge,C as he}from"./ConfirmationModal-C_oO7QLW.js";import{b as be,Q as j,a as z,h as R}from"./QMenu-Bv4-7jnn.js";import{Q as we,C as T}from"./ClosePopup-CbTDksMi.js";import{Q as W}from"./QForm-BsOaUD0C.js";import{u as ke,_ as X}from"./FormModal-3_KjRAQA.js";import{u as xe}from"./useResourceUpdate-a58ld08K.js";import{u as Y}from"./useResourceShow-DPDX-8vq.js";import{Q as Ce}from"./QBadge-DqKeR-yY.js";import{_ as $e}from"./ShowModal-G5KzTtC5.js";import{u as Qe}from"./useTextTruncate-BXow-7eB.js";import"./QSelect-BsTDJULy.js";import"./format-BOf40pHW.js";import"./QDrawer-BZwB_FoC.js";/* empty css               */import"./useFetch-CRpE6LrY.js";import"./QSpace-92-bbKT5.js";import"./QInnerLoading-CiQDGj4V.js";const Se={__name:"ActionsColumn",props:{row:{type:Object,required:!0}},emits:["delete","show-details","edit"],setup(_,{emit:v}){const a=v,m=l=>{a("delete",l)},r=l=>{a("edit",l)},c=l=>{a("show-details",l)};return(l,s)=>(y(),Q(ce,{icon:"sym_r_more_horiz",padding:"xs",size:"sm",unelevated:""},{default:t(()=>[e(be,{offset:[15,6],"transition-show":"jump-down","transition-hide":"jump-up",class:"q-pa-xs rounded-lg dark:bg-slate-700 shadow-lg border dark:border-none min-w-48"},{default:t(()=>[e(we,{style:{"min-width":"100px"},dense:"",class:"q-pa-xs"},{default:t(()=>[M((y(),Q(j,{onClick:s[0]||(s[0]=g=>c(_.row)),clickable:"",class:"text-gray-600 dark:text-gray-200 rounded-md"},{default:t(()=>[e(z,null,{default:t(()=>[e(R,{class:"flex-nowrap"},{default:t(()=>[e(S,{name:"sym_r_visibility",size:"xs",class:"me-1"}),V(" "+f(l.$t("view_details")),1)]),_:1})]),_:1})]),_:1})),[[T]]),M((y(),Q(j,{onClick:s[1]||(s[1]=g=>r(_.row)),clickable:"",class:"text-gray-600 dark:text-gray-200 rounded-md"},{default:t(()=>[e(z,null,{default:t(()=>[e(R,{class:"flex-nowrap"},{default:t(()=>[e(S,{name:"sym_r_edit",size:"xs",class:"me-1"}),V(" "+f(l.$t("edit")),1)]),_:1})]),_:1})]),_:1})),[[T]]),e(I,{class:"q-my-xs"}),M((y(),Q(j,{onClick:s[2]||(s[2]=g=>m(_.row)),clickable:"",class:"text-red-600 dark:text-red-400 rounded-md"},{default:t(()=>[e(z,null,{default:t(()=>[e(R,{class:"flex-nowrap"},{default:t(()=>[e(S,{name:"sym_r_delete",size:"xs",class:"me-1"}),V(" "+f(l.$t("delete")),1)]),_:1})]),_:1})]),_:1})),[[T]])]),_:1})]),_:1})]),_:1}))}},Ue={__name:"CreateForm",props:{open:{},openModifiers:{}},emits:B(["created"],["update:open"]),setup(_,{emit:v}){const a=O(_,"open"),m=v,r=k({}),{create:c,creating:l,validation:s}=ke("ssh-keys"),g=async()=>{await c(r.value),i(),m("created")},i=()=>{r.value={},s.value={},a.value=!1};return($,x)=>(y(),D("template",null,[e(X,{open:a.value,"onUpdate:open":x[1]||(x[1]=p=>a.value=p),title:"ssh_keys.create",form:"ssh-key-form",onClose:i,loading:o(l)},{form:t(()=>[e(W,{id:"ssh-key-form",onSubmit:G(g,["prevent","self"]),class:"q-gutter-md"},{default:t(()=>[e(H,{dense:"",modelValue:r.value.name,"onUpdate:modelValue":x[0]||(x[0]=p=>r.value.name=p),label:$.$t("name"),"error-message":o(s).name?.[0],error:"name"in o(s),outlined:"","hide-bottom-space":""},null,8,["modelValue","label","error-message","error"])]),_:1})]),_:1},8,["open","loading"])]))}},Ve={__name:"EditForm",props:B({id:{type:[Number,String]}},{open:{},openModifiers:{}}),emits:B(["updated"],["update:open"]),setup(_,{emit:v}){const a=_,m=O(_,"open"),r=v,{data:c,fetch:l,loading:s}=Y("ssh-keys"),{update:g,updating:i,validation:$}=xe("ssh-keys"),x=async()=>{await g(a.id,c.value),p(),r("updated")},p=()=>{c.value={},$.value={},m.value=!1};return J([()=>a.id,m],async h=>{m&&h&&await l(h)}),(h,b)=>(y(),D("template",null,[e(X,{open:m.value,"onUpdate:open":b[1]||(b[1]=w=>m.value=w),title:"ssh_keys.edit",form:"ssh-key-form",onClose:p,loading:o(i),"modal-loading":o(s)},{form:t(()=>[e(W,{id:"ssh-key-form",onSubmit:G(x,["prevent","self"]),class:"q-gutter-md"},{default:t(()=>[e(H,{dense:"",modelValue:o(c).name,"onUpdate:modelValue":b[0]||(b[0]=w=>o(c).name=w),label:h.$t("name"),"error-message":o($).name?.[0],error:"name"in o($),outlined:"","hide-bottom-space":""},null,8,["modelValue","label","error-message","error"])]),_:1})]),_:1},8,["open","loading","modal-loading"])]))}},De={class:"bg-primary-50 flex justify-center items-center w-fit p-3 rounded-full"},qe={class:"text-h6 text-center mb-4"},Me={class:"grid grid-cols-2 justify-between mt-5"},je={class:"text-subtitle2"},ze={class:"text-gray-700 dark:text-gray-400 text-end",style:{"font-family":"monospace, sans-serif","word-break":"break-all","white-space":"normal"}},Re={class:"grid grid-cols-2 justify-between mt-3"},Te={class:"text-subtitle2"},Ie={class:"text-gray-700 dark:text-gray-400 text-end"},Be={class:"mt-5"},Ee={class:"grid grid-cols-2 justify-between items-center"},Ne={class:"p-2 w-fit rounded-md bg-primary-50"},Fe={class:"text-sm font-medium"},Ke={class:"w-fit"},Le={__name:"ShowDetailsView",props:{id:{type:[String,Number]}},setup(_){const v=_,{data:a,fetch:m,loading:r}=Y("ssh-keys"),{truncate:c}=Qe(),l=E(()=>a.value.servers?a.value.servers.map(s=>({id:s.id,instance_id:c(s.instance_id,25),status:{label:s.status.label,color:s.status.color}})):[]);return J(()=>v.id,s=>{s&&m(s)}),(s,g)=>(y(),Q($e,{title:"ssh_keys.ssh_key_details",loading:o(r)},{content:t(()=>[e(P,{class:"shadow-none bg-transparent"},{default:t(()=>[e(U,{class:"p-0 flex justify-center items-center"},{default:t(()=>[u("div",De,[e(S,{name:"sym_r_key",size:"xl",color:"primary"})])]),_:1}),e(U,{class:"q-pa-md"},{default:t(()=>[u("div",qe,f(o(a)?.name),1),u("div",Me,[u("div",je,f(s.$t("ssh_keys.public_key")),1),u("div",ze,f(o(a)?.public_key)+"***** ",1)]),e(I,{class:"mt-2"}),u("div",Re,[u("div",Te,f(s.$t("creation_date")),1),u("div",Ie,f(o(a)?.created_at),1)]),l.value&&l.value.length?(y(),D(A,{key:0},[e(I,{class:"mt-2"}),u("div",Be,f(s.$t("assigned_servers")),1),u("div",Ee,[(y(!0),D(A,null,fe(l.value,i=>(y(),Q(P,{key:i.id,class:"flex flex-nowrap gap-2 items-center p-3 border w-fit mt-3"},{default:t(()=>[e(U,{class:"p-0"},{default:t(()=>[u("div",Ne,[e(S,{name:"sym_r_host",size:"sm",class:"text-primary"})])]),_:1}),e(U,{class:"p-0"},{default:t(()=>[u("div",Fe,f(i.instance_id),1),u("div",Ke,[e(Ce,{"text-color":i.status.color,size:"xs",class:"q-mt-xs"},{default:t(()=>[V(f(i.status.label),1)]),_:2},1032,["text-color"])])]),_:2},1024)]),_:2},1024))),128))])],64)):pe("",!0)]),_:1})]),_:1})]),_:1},8,["loading"]))}},Pe={class:"mt-4 bg-white dark:bg-slate-800 p-3 rounded-md"},Ae={class:"flex items-center justify-between gap-3 mb-3"},Oe={class:"break-all",style:{"font-family":"monospace, sans-serif"}},_t={__name:"IndexView",setup(_){const{data:v,fetch:a,loading:m,options:r,onRequest:c}=ve("ssh-keys"),{destroy:l,destroyed:s,destroying:g}=ge("ssh-keys"),{t:i}=_e(),$=E(()=>[{name:"id",label:i("id"),field:"id",sortable:!0,align:"left"},{name:"name",label:i("name"),field:"name",sortable:!0,align:"left"},{name:"public_key",label:i("ssh_keys.public_key"),field:"public_key",align:"left"},{name:"servers_count",label:i("assigned_servers"),field:"servers_count",align:"center"},{name:"created_at",label:i("creation_details"),sortable:!0,field:"created_at",align:"left"},{name:"actions",label:i("actions"),field:"actions",align:"center"}]),x=E(()=>[{name:"created_at",label:i("creation_date"),type:"date"}]),p=k(""),h=k(!1),b=k(!1),w=k(!1),q=k(!1),N=k(null),F=k(null),K=k(null),Z=({search:C,filters:d})=>{a({search:C,filters:d})},ee=()=>{c({filter:p.value})},te=C=>{K.value=C,q.value=!0},se=C=>{N.value=C,b.value=!0},ae=()=>{h.value=!1,a({filter:p.value,filters:r.filters})},le=()=>{b.value=!1,a({filter:p.value,filters:r.filters})},oe=C=>{w.value=!0,F.value=C},ne=async()=>{await l(F.value.id),s.value&&ie()},ie=()=>{w.value=!1,a({filter:p.value,filters:r.filters})};return(C,d)=>(y(),Q(me,{class:"q-pa-md"},{default:t(()=>[e(Ue,{open:h.value,"onUpdate:open":d[0]||(d[0]=n=>h.value=n),onCreated:ae},null,8,["open"]),e(Ve,{open:b.value,"onUpdate:open":d[1]||(d[1]=n=>b.value=n),id:N.value?.id,onUpdated:le},null,8,["open","id"]),e(Le,{open:q.value,"onUpdate:open":d[2]||(d[2]=n=>q.value=n),id:K.value?.id},null,8,["open","id"]),e(he,{open:w.value,"onUpdate:open":d[3]||(d[3]=n=>w.value=n),title:"ssh_keys.delete",icon:"warning",color:"negative",loading:o(g),onConfirm:ne,onCancel:d[4]||(d[4]=n=>w.value=!1)},null,8,["open","loading"]),e(ye,{title:"ssh_keys.title",subtitle:"ssh_keys.subtitle",icon:"key",actionLabel:"ssh_keys.create",actionIcon:"add",action:()=>h.value=!0},null,8,["action"]),u("div",Pe,[u("div",Ae,[e(re,{onSearch:ee,searchValue:p.value,"onUpdate:searchValue":d[5]||(d[5]=n=>p.value=n),class:"md:max-w-sm max-w-full"},null,8,["searchValue"]),e(de,{filters:x.value,onUpdate:Z},null,8,["filters"])]),e(ue,{columns:$.value,rows:o(v)??[],loading:o(m),pagination:o(r).pagination,"onUpdate:pagination":d[6]||(d[6]=n=>o(r).pagination=n),onRequest:o(c),flat:"","rows-per-page-options":[5,10,20,30,40,50,100]},{"body-cell-public_key":t(n=>[e(L,{props:n},{default:t(()=>[u("span",Oe,f(n.row.public_key)+"*****",1)]),_:2},1032,["props"])]),"body-cell-actions":t(n=>[e(L,{props:n},{default:t(()=>[e(Se,{row:n.row,onShowDetails:te,onEdit:se,onDelete:oe},null,8,["row"])]),_:2},1032,["props"])]),_:1},8,["columns","rows","loading","pagination","onRequest"])])]),_:1}))}};export{_t as default};
