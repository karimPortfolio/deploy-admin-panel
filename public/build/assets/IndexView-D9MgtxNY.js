import{Q as P}from"./QImg-BE0GSjEp.js";import{c as g,o as v,w as a,b as e,a as q,d as b,Q as j,t as n,e as h,k as ce,D as me,l as fe,g as B,i as l,h as E,j as o,ad as ve,ae as pe,a0 as G,v as x,f as _e,a6 as ge,af as R,aj as ye,x as D}from"./app-CVo2F_W3.js";import{a as be,b as we,Q as he,c as M}from"./SearchBar-DJxEruSr.js";import{Q as $}from"./QBadge-DqKeR-yY.js";import{Q as xe}from"./QPage-BBLQyAC7.js";import{_ as ke}from"./PageHeader-CeaXU9p-.js";import{u as $e}from"./useResourceIndex-OJHyqOIO.js";import{u as F}from"./useResourceUpdate-a58ld08K.js";import{u as Ce,C as O}from"./ConfirmationModal-C_oO7QLW.js";import{b as Qe,Q as I,a as N,h as T}from"./QMenu-Bv4-7jnn.js";import{Q as Ve,C as L}from"./ClosePopup-CbTDksMi.js";import{_ as je}from"./ShowModal-G5KzTtC5.js";import{u as Se}from"./useResourceShow-DPDX-8vq.js";import{u as Ue}from"./useTextTruncate-BXow-7eB.js";import{Q as Ae}from"./QSelect-BsTDJULy.js";import{Q as De}from"./QForm-BsOaUD0C.js";import{u as Me,_ as qe}from"./FormModal-3_KjRAQA.js";/* empty css               */import"./QDrawer-BZwB_FoC.js";import"./format-BOf40pHW.js";import"./useFetch-CRpE6LrY.js";import"./QSpace-92-bbKT5.js";import"./QInnerLoading-CiQDGj4V.js";const Ie={__name:"ActionsColumn",props:{row:{type:Object,required:!0}},emits:["delete","show-details","status-change"],setup(w,{emit:d}){const r=d,V=t=>{r("delete",t)},m=(t,c)=>{r("status-change",t,c)},i=t=>{r("show-details",t)};return(t,c)=>(v(),g(ce,{icon:"sym_r_more_horiz",padding:"xs",size:"sm",unelevated:""},{default:a(()=>[e(Qe,{offset:[15,6],"transition-show":"jump-down","transition-hide":"jump-up",class:"q-pa-xs rounded-lg dark:bg-slate-700 shadow-lg border dark:border-none min-w-48"},{default:a(()=>[e(Ve,{style:{"min-width":"100px"},dense:"",class:"q-pa-xs"},{default:a(()=>[q((v(),g(I,{onClick:c[0]||(c[0]=C=>i(w.row)),clickable:"",class:"text-gray-600 dark:text-gray-200 rounded-md"},{default:a(()=>[e(N,null,{default:a(()=>[e(T,{class:"flex-nowrap"},{default:a(()=>[e(j,{name:"sym_r_visibility",size:"xs",class:"me-1"}),b(" "+n(t.$t("view_details")),1)]),_:1})]),_:1})]),_:1})),[[L]]),w.row.is_active?q((v(),g(I,{key:0,onClick:c[1]||(c[1]=C=>m(w.row,"deactivate")),clickable:"",class:"text-red-600 dark:text-red-400 rounded-md"},{default:a(()=>[e(N,null,{default:a(()=>[e(T,{class:"flex-nowrap"},{default:a(()=>[e(j,{name:"sym_r_cancel",size:"xs",class:"me-1"}),b(" "+n(t.$t("deactivate")),1)]),_:1})]),_:1})]),_:1})),[[L]]):q((v(),g(I,{key:1,onClick:c[2]||(c[2]=C=>m(w.row,"activate")),clickable:"",class:"text-green-600 dark:text-green-400 rounded-md"},{default:a(()=>[e(N,null,{default:a(()=>[e(T,{class:"flex-nowrap"},{default:a(()=>[e(j,{name:"sym_r_play_circle",size:"xs",class:"me-1"}),b(" "+n(t.$t("activate")),1)]),_:1})]),_:1})]),_:1})),[[L]]),e(h,{class:"q-my-xs"}),q((v(),g(I,{onClick:c[3]||(c[3]=C=>V(w.row)),clickable:"",class:"text-red-600 dark:text-red-400 rounded-md"},{default:a(()=>[e(N,null,{default:a(()=>[e(T,{class:"flex-nowrap"},{default:a(()=>[e(j,{name:"sym_r_delete",size:"xs",class:"me-1"}),b(" "+n(t.$t("delete")),1)]),_:1})]),_:1})]),_:1})),[[L]])]),_:1})]),_:1})]),_:1}))}},Ne={class:"flex justify-center items-center w-fit border rounded-full"},Te={class:"grid grid-cols-2 justify-between mt-5"},Le={class:"text-subtitle2"},Re={class:"text-gray-700 dark:text-gray-400 text-end"},ze={class:"grid grid-cols-2 justify-between mt-3"},Be={class:"text-subtitle2"},Fe={class:"text-gray-700 dark:text-gray-400 text-end"},Oe={class:"grid grid-cols-2 justify-between mt-3"},Pe={class:"text-subtitle2"},Ee={class:"text-gray-700 dark:text-gray-400 text-end"},Ge={class:"grid grid-cols-2 justify-between mt-3"},He={class:"text-subtitle2"},Je={class:"text-gray-700 dark:text-gray-400 text-end"},Ke={class:"grid grid-cols-2 justify-between mt-3"},We={class:"text-subtitle2"},Xe={class:"text-gray-700 dark:text-gray-400 flex justify-end"},Ye={class:"grid grid-cols-2 justify-between mt-3"},Ze=["title"],et={class:"text-gray-700 dark:text-gray-400 flex justify-end"},tt={class:"grid grid-cols-2 justify-between mt-3"},at=["title"],st={class:"text-gray-700 dark:text-gray-400 flex justify-end"},lt={class:"grid grid-cols-2 justify-between mt-3"},ot=["title"],nt={class:"text-gray-700 dark:text-gray-400 flex justify-end"},it={class:"grid grid-cols-2 justify-between mt-3"},rt={class:"text-subtitle2"},dt={class:"text-gray-700 dark:text-gray-400 flex justify-end"},ut={class:"grid grid-cols-2 justify-between mt-3"},ct={class:"text-subtitle2"},mt={class:"text-gray-700 dark:text-gray-400 text-end"},ft={__name:"ShowDetailsView",props:{id:{type:[String,Number]}},setup(w){const d=w,{data:r,fetch:V,loading:m}=Se("admin/users"),{truncate:i}=Ue();return me(()=>d.id,t=>{t&&V(t)}),(t,c)=>(v(),g(je,{title:"users.user_details",loading:o(m)},{content:a(()=>[e(fe,{class:"shadow-none bg-transparent"},{default:a(()=>[e(B,{class:"p-0 flex justify-center items-center"},{default:a(()=>[l("div",Ne,[e(E,{class:"w-20 h-20"},{default:a(()=>[e(P,{src:o(r)?.photo??"/src/img/avatar.png"},null,8,["src"])]),_:1})])]),_:1}),e(B,{class:"q-pa-md"},{default:a(()=>[l("div",Te,[l("div",Le,n(t.$t("name")),1),l("div",Re,n(o(r)?.name),1)]),e(h,{class:"mt-2"}),l("div",ze,[l("div",Be,n(t.$t("users.company_name")),1),l("div",Fe,n(o(r)?.company_name||"N/A"),1)]),e(h,{class:"mt-2"}),l("div",Oe,[l("div",Pe,n(t.$t("users.email")),1),l("div",Ee,n(o(r)?.email||"N/A"),1)]),e(h,{class:"mt-2"}),l("div",Ge,[l("div",He,n(t.$t("users.role")),1),l("div",Je,n(o(r)?.role?.label||"N/A"),1)]),e(h,{class:"mt-2"}),l("div",Ke,[l("div",We,n(t.$t("status")),1),l("div",Xe,[o(r)?.is_active?(v(),g($,{key:0,"text-color":"positive",label:t.$t("active"),class:"w-fit"},null,8,["label"])):(v(),g($,{key:1,"text-color":"negative",label:t.$t("inactive"),class:"w-fit"},null,8,["label"]))])]),e(h,{class:"mt-2"}),l("div",Ye,[l("div",{class:"text-subtitle2",title:t.$t("users.total_servers_created")},n(o(i)(t.$t("users.total_servers_created"),40)),9,Ze),l("div",et,[e($,{"text-color":"primary",class:"w-fit"},{default:a(()=>[e(j,{name:"sym_r_host",class:"inline-block mr-1"}),b(" "+n(o(r)?.servers_count),1)]),_:1})])]),e(h,{class:"mt-2"}),l("div",tt,[l("div",{class:"text-subtitle2",title:t.$t("users.total_security_groups_created")},n(o(i)(t.$t("users.total_security_groups_created"),40)),9,at),l("div",st,[e($,{"text-color":"primary",class:"w-fit"},{default:a(()=>[e(j,{name:"sym_r_security",class:"inline-block mr-1"}),b(" "+n(o(r)?.security_groups_count),1)]),_:1})])]),e(h,{class:"mt-2"}),l("div",lt,[l("div",{class:"text-subtitle2",title:t.$t("users.total_ssh_keys_created")},n(o(i)(t.$t("users.total_ssh_keys_created"),40)),9,ot),l("div",nt,[e($,{"text-color":"primary",class:"w-fit"},{default:a(()=>[e(j,{name:"sym_r_key",class:"inline-block mr-1"}),b(" "+n(o(r)?.ssh_keys_count),1)]),_:1})])]),e(h,{class:"mt-2"}),l("div",it,[l("div",rt,n(t.$t("users.activity")),1),l("div",dt,[o(r)?.session?(v(),g($,{key:0,"text-color":"positive",label:t.$t("users.online"),class:"w-fit"},null,8,["label"])):(v(),g($,{key:1,"text-color":"negative",label:t.$t("users.offline"),class:"w-fit"},null,8,["label"]))])]),e(h,{class:"mt-2"}),l("div",ut,[l("div",ct,n(t.$t("creation_date")),1),l("div",mt,n(o(r)?.created_at),1)])]),_:1})]),_:1})]),default:a(()=>[c[0]||(c[0]=b(" > ",-1))]),_:1},8,["loading"]))}},vt={__name:"CreateView",props:{open:{},openModifiers:{}},emits:ve(["created"],["update:open"]),setup(w,{emit:d}){const r=pe(w,"open"),V=d,{t:m}=G(),i=x({is_active:!0}),t=[{label:m("users.admin"),value:"admin"},{label:m("users.user"),value:"user"}],{create:c,creating:C,validation:y}=Me("admin/users"),U=async()=>{await c(i.value),k(),V("created")},k=()=>{i.value={},y.value={},r.value=!1};return(p,f)=>(v(),_e("template",null,[e(qe,{open:r.value,"onUpdate:open":f[5]||(f[5]=_=>r.value=_),title:"users.create",form:"user-creation-form",onClose:k,loading:o(C)},{form:a(()=>[e(De,{id:"user-creation-form",onSubmit:ge(U,["prevent","self"]),class:"q-gutter-md"},{default:a(()=>[e(R,{dense:"",modelValue:i.value.name,"onUpdate:modelValue":f[0]||(f[0]=_=>i.value.name=_),label:p.$t("name")+"*","error-message":o(y).name?.[0],error:"name"in o(y),outlined:"","hide-bottom-space":""},null,8,["modelValue","label","error-message","error"]),e(R,{dense:"",modelValue:i.value.company_name,"onUpdate:modelValue":f[1]||(f[1]=_=>i.value.company_name=_),label:p.$t("users.company_name"),"error-message":o(y).company_name?.[0],error:"company_name"in o(y),outlined:"","hide-bottom-space":""},null,8,["modelValue","label","error-message","error"]),e(R,{dense:"",modelValue:i.value.email,"onUpdate:modelValue":f[2]||(f[2]=_=>i.value.email=_),label:p.$t("users.email")+"*","error-message":o(y).email?.[0],error:"email"in o(y),outlined:"","hide-bottom-space":""},null,8,["modelValue","label","error-message","error"]),e(Ae,{dense:"",modelValue:i.value.role,"onUpdate:modelValue":f[3]||(f[3]=_=>i.value.role=_),options:t,label:p.$t("users.role"),"error-message":o(y).role?.[0],error:"role"in o(y),outlined:"","hide-bottom-space":""},null,8,["modelValue","label","error-message","error"]),e(ye,{modelValue:i.value.is_active,"onUpdate:modelValue":f[4]||(f[4]=_=>i.value.is_active=_),label:p.$t("users.activate_user_account"),color:"primary",dense:"",class:"flex"},null,8,["modelValue","label"])]),_:1})]),_:1},8,["open","loading"])]))}},pt={class:"mt-4 bg-white dark:bg-slate-800 p-3 rounded-md"},_t={class:"flex items-center justify-between gap-3 mb-3"},zt={__name:"IndexView",setup(w){const{t:d}=G(),r=D(()=>[{name:"id",label:d("id"),field:"id",align:"left",sortable:!0},{name:"name",label:d("name"),field:"name",align:"left",sortable:!0},{name:"company_name",label:d("users.company_name"),field:"company_name",align:"left",sortable:!1},{name:"email",label:d("users.email"),field:"email",align:"left",sortable:!0},{name:"role",label:d("users.role"),field:"role",align:"left",sortable:!1},{name:"status",label:d("status"),field:"is_active",align:"left",sortable:!1},{name:"created_at",label:d("creation_date"),field:"created_at",align:"left",sortable:!0},{label:d("actions"),name:"actions",field:"actions",align:"center"}]),V=D(()=>[{name:"role",label:d("users.role"),type:"enum",resource:"admin/users/roles",optionLabel:"label",optionValue:"value"},{name:"created_at",label:d("creation_date"),type:"date"}]),m=x(""),i=x(!1),t=x(!1),c=x(!1),C=x(null),y=x(null),U=x(null),k=x(!1),p=x(!1),f=D(()=>p.value==="activate"?d("users.activate_user_account"):d("users.deactivate_user_account")),_=D(()=>p.value==="activate"?d("activate"):d("deactivate")),H=D(()=>p.value==="activate"?X.value:Z.value),{data:J,loading:K,fetch:A,options:S,onRequest:z}=$e("admin/users"),{update:W,updating:X}=F(()=>`admin/users/${U.value.id}/activate`),{update:Y,updating:Z}=F(()=>`admin/users/${U.value.id}/deactivate`),{destroy:ee,destroying:te,destroyed:ae}=Ce("admin/users"),se=()=>{z({filter:m.value})},le=()=>{t.value=!1,A({filter:m.value,filters:S.filters})};function oe({search:Q,filters:u}){A({filter:Q,filters:u})}const ne=(Q,u)=>{U.value=Q,p.value=u,k.value=!0},ie=Q=>{y.value=Q,c.value=!0},re=async()=>{if(p.value==="activate")return await W(),k.value=!1,p.value=null,A({filter:m.value,filters:S.filters});await Y(),k.value=!1,p.value=null,A({filter:m.value,filters:S.filters})},de=Q=>{C.value=Q,i.value=!0},ue=async()=>{await ee(C.value.id),ae.value&&(i.value=!1,A({filter:m.value,filters:S.filters}))};return(Q,u)=>(v(),g(xe,{class:"q-pa-md"},{default:a(()=>[e(ft,{open:c.value,"onUpdate:open":u[0]||(u[0]=s=>c.value=s),id:y.value?.id},null,8,["open","id"]),e(vt,{open:t.value,"onUpdate:open":u[1]||(u[1]=s=>t.value=s),onCreated:le},null,8,["open"]),e(O,{open:i.value,"onUpdate:open":u[2]||(u[2]=s=>i.value=s),title:"users.delete",icon:"warning",color:"negative",loading:o(te),onConfirm:ue,onCancel:u[3]||(u[3]=s=>i.value=!1)},null,8,["open","loading"]),e(O,{open:k.value,"onUpdate:open":u[4]||(u[4]=s=>k.value=s),title:f.value,icon:"info",color:"warning",actionLabel:_.value,loading:H.value,onConfirm:re,onCancel:u[5]||(u[5]=s=>k.value=!1)},null,8,["open","title","actionLabel","loading"]),e(ke,{title:"users.title",subtitle:"users.subtitle",icon:"sym_r_group",actionLabel:"users.create",actionIcon:"sym_r_add",action:()=>t.value=!0},null,8,["action"]),l("div",pt,[l("div",_t,[e(be,{onSearch:se,searchValue:m.value,"onUpdate:searchValue":u[6]||(u[6]=s=>m.value=s),class:"md:max-w-sm max-w-full"},null,8,["searchValue"]),e(we,{filters:V.value,onUpdate:oe},null,8,["filters"])]),e(he,{columns:r.value,rows:o(J)??[],loading:o(K),pagination:o(S).pagination,"onUpdate:pagination":u[7]||(u[7]=s=>o(S).pagination=s),onRequest:o(z),flat:"","rows-per-page-options":[5,10,20,30,40,50,100]},{"body-cell-name":a(s=>[e(M,{props:s,title:s.row.name},{default:a(()=>[e(E,{class:"w-8 h-8 mr-1"},{default:a(()=>[e(P,{src:s.row?.photo??"/src/img/avatar.png"},null,8,["src"])]),_:2},1024),b(" "+n(s.row.name??"N/A"),1)]),_:2},1032,["props","title"])]),"body-cell-company_name":a(s=>[e(M,{props:s,title:s.row.company_name},{default:a(()=>[b(n(s.row.company_name??"N/A"),1)]),_:2},1032,["props","title"])]),"body-cell-role":a(s=>[e(M,{props:s,title:s.row.role},{default:a(()=>[b(n(s.row.role?.label??"N/A"),1)]),_:2},1032,["props","title"])]),"body-cell-status":a(s=>[e(M,{props:s,title:s.row.status},{default:a(()=>[s.row.is_active?(v(),g($,{key:0,"text-color":"positive",label:"Active",class:"w-fit"})):(v(),g($,{key:1,"text-color":"negative",label:"Inactive",class:"w-fit"}))]),_:2},1032,["props","title"])]),"body-cell-actions":a(s=>[e(M,{props:s},{default:a(()=>[e(Ie,{row:s.row,onDelete:de,onShowDetails:ie,onStatusChange:ne},null,8,["row"])]),_:2},1032,["props"])]),_:1},8,["columns","rows","loading","pagination","onRequest"])])]),_:1}))}};export{zt as default};
