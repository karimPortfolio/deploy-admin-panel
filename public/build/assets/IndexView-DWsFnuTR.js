import{a as le,b as ne,Q as re,c as w}from"./SearchBar-DJxEruSr.js";import{Q as oe}from"./QBadge-DqKeR-yY.js";import{Q as ie}from"./QPage-BBLQyAC7.js";import{c as h,o as n,w as a,b as t,a as V,d as p,Q,t as r,e as ue,k as de,f as i,i as c,j as m,a0 as ce,x as C,v as b,U as me,E as pe}from"./app-CVo2F_W3.js";import{_ as fe}from"./PageHeader-CeaXU9p-.js";import{u as _e}from"./useResourceIndex-OJHyqOIO.js";import{u as ve,C as j}from"./ConfirmationModal-C_oO7QLW.js";import{u as z}from"./useResourceUpdate-a58ld08K.js";import{u as L}from"./useTextTruncate-BXow-7eB.js";import{u as ye}from"./usePollingInterval-ClLiuZEZ.js";import{b as ge,Q as N,a as q,h as D}from"./QMenu-Bv4-7jnn.js";import{Q as we,C as I}from"./ClosePopup-CbTDksMi.js";import{u as be}from"./index-DZucgB02.js";import"./QSelect-BsTDJULy.js";import"./format-BOf40pHW.js";import"./QDrawer-BZwB_FoC.js";/* empty css               */import"./useFetch-CRpE6LrY.js";const xe={__name:"ActionsColumn",props:{row:{type:Object,required:!0}},emits:["delete","show-details","status-change"],setup(l,{emit:s}){const v=s,u=_=>{v("delete",_)},f=(_,d)=>{v("status-change",_,d)};return(_,d)=>(n(),h(de,{icon:"sym_r_more_horiz",padding:"xs",size:"sm",unelevated:""},{default:a(()=>[t(ge,{offset:[15,6],"transition-show":"jump-down","transition-hide":"jump-up",class:"q-pa-xs rounded-lg dark:bg-slate-700 shadow-lg border dark:border-none min-w-48"},{default:a(()=>[t(we,{style:{"min-width":"100px"},dense:"",class:"q-pa-xs"},{default:a(()=>[V((n(),h(N,{to:{name:"admin.servers.show",params:{id:l.row.id}},clickable:"",class:"text-gray-600 dark:text-gray-200 rounded-md"},{default:a(()=>[t(q,null,{default:a(()=>[t(D,{class:"flex-nowrap"},{default:a(()=>[t(Q,{name:"sym_r_visibility",size:"xs",class:"me-1"}),p(" "+r(_.$t("view_details")),1)]),_:1})]),_:1})]),_:1},8,["to"])),[[I]]),l.row.status.value==="running"?V((n(),h(N,{key:0,onClick:d[0]||(d[0]=S=>f(l.row,"stop")),clickable:"",class:"text-yellow-600 dark:text-yellow-400 rounded-md"},{default:a(()=>[t(q,null,{default:a(()=>[t(D,{class:"flex-nowrap"},{default:a(()=>[t(Q,{name:"sym_r_stop_circle",size:"xs",class:"me-1"}),p(" "+r(_.$t("servers.stop_server")),1)]),_:1})]),_:1})]),_:1})),[[I]]):V((n(),h(N,{key:1,onClick:d[1]||(d[1]=S=>f(l.row,"start")),clickable:"",class:"text-green-600 dark:text-green-400 rounded-md"},{default:a(()=>[t(q,null,{default:a(()=>[t(D,{class:"flex-nowrap"},{default:a(()=>[t(Q,{name:"sym_r_play_circle",size:"xs",class:"me-1"}),p(" "+r(_.$t("servers.start_server")),1)]),_:1})]),_:1})]),_:1})),[[I]]),t(ue,{class:"q-my-xs"}),V((n(),h(N,{onClick:d[2]||(d[2]=S=>u(l.row)),clickable:"",class:"text-red-600 dark:text-red-400 rounded-md"},{default:a(()=>[t(q,null,{default:a(()=>[t(D,{class:"flex-nowrap"},{default:a(()=>[t(Q,{name:"sym_r_delete",size:"xs",class:"me-1"}),p(" "+r(_.$t("delete")),1)]),_:1})]),_:1})]),_:1})),[[I]])]),_:1})]),_:1})]),_:1}))}},ke={key:0},he={class:"font-medium me-2 text-gray-600 dark:text-gray-400"},$e={key:0},Ce={key:1},Qe={key:0},Se={key:1},Ve={key:1},Ne={__name:"InstanceTypeColumn",props:{row:{type:Object,required:!0}},setup(l){const{truncate:s}=L();return(v,u)=>l.row.instance_type?(n(),i("div",ke,[p(r(l.row.instance_type.value)+" ",1),c("div",null,[c("span",he,r(v.$t("servers.image"))+":",1),l.row.image_id?(n(),i("span",$e,r(m(s)(l.row.image_id,10)),1)):(n(),i("span",Ce,"N/A"))]),c("div",null,[u[0]||(u[0]=c("span",{class:"font-medium me-2 text-gray-600 dark:text-gray-400"},"OS:",-1)),l.row.os_family?(n(),i("span",Qe,[t(Q,{name:l.row.os_family?.icon},null,8,["name"]),p(" "+r(l.row.os_family?.label),1)])):(n(),i("span",Se,"N/A"))])])):(n(),i("div",Ve,[...u[1]||(u[1]=[c("div",null,"N/A",-1)])]))}},qe={key:0},De={key:0},Ie={key:1},Le={key:1},Ae={__name:"SecurityGroupColumn",props:{row:{type:Object,required:!0}},setup(l){const{truncate:s}=L();return(v,u)=>l.row.security_group?(n(),i("div",qe,[p(r(m(s)(l.row.security_group.group_id,15))+" ",1),c("div",null,[u[0]||(u[0]=c("span",{class:"font-medium me-2 text-gray-600 dark:text-gray-400"},"VPC:",-1)),l.row.vpc_id?(n(),i("span",De,r(m(s)(l.row.vpc_id,10)),1)):(n(),i("span",Ie,"N/A"))])])):(n(),i("div",Le,[...u[1]||(u[1]=[c("div",null,"N/A",-1)])]))}},Te={class:"font-medium me-2 text-gray-600 dark:text-gray-400"},Ue={key:0},je={key:1},ze={__name:"InstanceNameColumn",props:{row:{type:Object,required:!0}},setup(l){const{truncate:s}=L();return(v,u)=>(n(),i("div",null,[p(r(m(s)(l.row.name,30))+" ",1),c("div",null,[c("span",Te,r(v.$t("servers.instance_id"))+":",1),l.row.instance_id?(n(),i("span",Ue,r(m(s)(l.row.instance_id,10)),1)):(n(),i("span",je,"N/A"))])]))}},Be={class:"mt-4 bg-white dark:bg-slate-800 p-3 rounded-md"},Me={class:"flex items-center justify-between gap-3 mb-3"},Re={class:"font-medium me-1 text-gray-600 dark:text-gray-400"},Oe={key:0},Pe={key:1},it={__name:"IndexView",setup(l){const{t:s}=ce(),v=C(()=>[{name:"id",label:s("id"),field:"id",align:"left",sortable:!0},{name:"name",label:s("name"),field:"name",align:"left",sortable:!0},{name:"security_group",label:s("security_groups.title"),field:"security_group",align:"left",sortable:!1},{name:"instance_type",label:s("servers.instance_type"),field:"instance_type",align:"left",sortable:!1},{name:"public_ip_address",label:s("servers.public_ip_address"),field:"public_ip_address",align:"left",sortable:!0},{name:"status",label:s("status"),field:"status",align:"left",sortable:!1},{name:"created_at",label:s("creation_details"),field:"created_at",align:"left",sortable:!0},{label:s("actions"),name:"actions",field:"actions",align:"center"}]),u=C(()=>[{name:"vpc_id",label:"VPC ID",type:"relation",resource:"vpcs",optionLabel:"vpc_id",optionValue:"vpc_id"},{name:"security_group_id",label:s("security_groups.group_id"),type:"relation",resource:"admin/security-groups",optionLabel:"group_id",optionValue:"group_id"},{name:"instance_type",label:s("servers.instance_type"),type:"enum",resource:"admin/servers/instance-types",optionLabel:"value",optionValue:"value"},{name:"os_family",label:s("servers.operating_system"),type:"enum",resource:"admin/servers/os-families",optionLabel:"value",optionValue:"value"},{name:"status",label:s("status"),type:"enum",resource:"admin/servers/statuses",optionLabel:"label",optionValue:"value"},{name:"created_at",label:s("creation_date"),type:"date"}]),f=b(""),{data:_,fetch:d,loading:S,options:x,onRequest:T}=_e("admin/servers"),{destroy:B,destroying:M,destroyed:R}=ve("admin/servers"),{update:O,updating:P}=z(()=>`admin/servers/${A.value.id}/start`),{update:E,updating:F}=z(()=>`admin/servers/${A.value.id}/stop`),{truncate:G}=L(),{start:H,stop:J}=ye(()=>{d({filter:f.value,filters:x.filters})},2e4);b(!1);const $=b(!1),k=b(!1),U=b(null),A=b(null),y=b(!1),K=C(()=>y.value==="start"?s("servers.start_server"):s("servers.stop_server")),W=C(()=>y.value==="start"?s("servers.start"):s("servers.stop")),X=C(()=>y.value==="start"?P.value:F.value),Y=()=>{T({filter:f.value})};function Z({search:g,filters:o}){d({filter:g,filters:o})}const ee=g=>{U.value=g,$.value=!0},te=(g,o)=>{A.value=g,y.value=o,k.value=!0},ae=async()=>{if(y.value==="start"){await O(),k.value=!1,y.value=null,d({filter:f.value,filters:x.filters});return}await E(),k.value=!1,y.value=null,d({filter:f.value,filters:x.filters})},se=async()=>{await B(U.value.id),R.value&&($.value=!1,d({filter:f.value,filters:x.filters}))};return me(()=>{be(H,3e3)()}),pe(()=>{J()}),(g,o)=>(n(),h(ie,{class:"q-pa-md"},{default:a(()=>[t(j,{open:$.value,"onUpdate:open":o[0]||(o[0]=e=>$.value=e),title:"servers.delete",icon:"warning",color:"negative",loading:m(M),onConfirm:se,onCancel:o[1]||(o[1]=e=>$.value=!1)},null,8,["open","loading"]),t(j,{open:k.value,"onUpdate:open":o[2]||(o[2]=e=>k.value=e),title:K.value,icon:"info",color:"warning",actionLabel:W.value,loading:X.value,onConfirm:ae,onCancel:o[3]||(o[3]=e=>k.value=!1)},null,8,["open","title","actionLabel","loading"]),t(fe,{title:"servers.title",subtitle:"servers.admin_subtitle",icon:"sym_r_host"}),c("div",Be,[c("div",Me,[t(le,{onSearch:Y,searchValue:f.value,"onUpdate:searchValue":o[4]||(o[4]=e=>f.value=e),class:"md:max-w-sm max-w-full"},null,8,["searchValue"]),t(ne,{filters:u.value,onUpdate:Z},null,8,["filters"])]),t(re,{columns:v.value,rows:m(_)??[],loading:m(S),pagination:m(x).pagination,"onUpdate:pagination":o[5]||(o[5]=e=>m(x).pagination=e),onRequest:m(T),flat:"","rows-per-page-options":[5,10,20,30,40,50,100]},{"body-cell-name":a(e=>[t(w,{props:e,title:e.row.instance_id},{default:a(()=>[t(ze,{row:e.row},null,8,["row"])]),_:2},1032,["props","title"])]),"body-cell-security_group":a(e=>[t(w,{props:e,title:e.row.security_group.group_id},{default:a(()=>[t(Ae,{row:e.row},null,8,["row"])]),_:2},1032,["props","title"])]),"body-cell-instance_type":a(e=>[t(w,{props:e,title:e.row.image_id},{default:a(()=>[t(Ne,{row:e.row},null,8,["row"])]),_:2},1032,["props","title"])]),"body-cell-public_ip_address":a(e=>[t(w,{props:e,title:e.row.public_ip_address},{default:a(()=>[p(r(e.row.public_ip_address??"N/A"),1)]),_:2},1032,["props","title"])]),"body-cell-status":a(e=>[t(w,{props:e,title:e.row.status.label},{default:a(()=>[t(oe,{"text-color":e.row.status.color,size:"xs",class:"w-fit"},{default:a(()=>[p(r(e.row.status.label),1)]),_:2},1032,["text-color"])]),_:2},1032,["props","title"])]),"body-cell-created_at":a(e=>[t(w,{props:e,title:e.row.created_by?.name??e.row.create_at},{default:a(()=>[p(r(e.row.created_at)+" ",1),c("div",null,[c("span",Re,r(g.$t("by"))+":",1),e.row.created_by?(n(),i("span",Oe,r(m(G)(e.row.created_by?.name,10)),1)):(n(),i("span",Pe,"N/A"))])]),_:2},1032,["props","title"])]),"body-cell-actions":a(e=>[t(w,{props:e},{default:a(()=>[t(xe,{row:e.row,onStatusChange:te,onDelete:ee},null,8,["row"])]),_:2},1032,["props"])]),_:1},8,["columns","rows","loading","pagination","onRequest"])])]),_:1}))}};export{it as default};
