import{a as W,b as X,Q as Y,c as S}from"./SearchBar-DJxEruSr.js";import{Q as Z}from"./QPage-BBLQyAC7.js";import{c as h,o as m,w as t,b as e,a as B,d as y,Q as C,t as o,e as j,k as ee,x as q,D as te,aa as se,l as I,g as $,i as a,f as Q,a1 as ae,j as r,a3 as N,a4 as le,a0 as oe,v as k}from"./app-CVo2F_W3.js";import{_ as ne}from"./PageHeader-CeaXU9p-.js";import{u as ie}from"./useResourceIndex-OJHyqOIO.js";import{u as re,C as de}from"./ConfirmationModal-C_oO7QLW.js";import{u as A}from"./useTextTruncate-BXow-7eB.js";import{b as ce,Q as R,a as U,h as M}from"./QMenu-Bv4-7jnn.js";import{Q as me,C as L}from"./ClosePopup-CbTDksMi.js";import{Q as ue}from"./QBadge-DqKeR-yY.js";import{_ as _e}from"./ShowModal-G5KzTtC5.js";import{u as pe}from"./useResourceShow-DPDX-8vq.js";import"./QSelect-BsTDJULy.js";import"./format-BOf40pHW.js";import"./QDrawer-BZwB_FoC.js";/* empty css               */import"./useFetch-CRpE6LrY.js";import"./QSpace-92-bbKT5.js";import"./QInnerLoading-CiQDGj4V.js";const fe={__name:"ActionsColumn",props:{row:{type:Object,required:!0}},emits:["delete","show-details"],setup(b,{emit:g}){const n=g,w=d=>{n("delete",d)},p=d=>{n("show-details",d)};return(d,c)=>(m(),h(ee,{icon:"sym_r_more_horiz",padding:"xs",size:"sm",unelevated:""},{default:t(()=>[e(ce,{offset:[15,6],"transition-show":"jump-down","transition-hide":"jump-up",class:"q-pa-xs rounded-lg dark:bg-slate-700 shadow-lg border dark:border-none min-w-48"},{default:t(()=>[e(me,{style:{"min-width":"100px"},dense:"",class:"q-pa-xs"},{default:t(()=>[B((m(),h(R,{onClick:c[0]||(c[0]=l=>p(b.row)),clickable:"",class:"text-gray-600 dark:text-gray-200 rounded-md"},{default:t(()=>[e(U,null,{default:t(()=>[e(M,{class:"flex-nowrap"},{default:t(()=>[e(C,{name:"sym_r_visibility",size:"xs",class:"me-1"}),y(" "+o(d.$t("view_details")),1)]),_:1})]),_:1})]),_:1})),[[L]]),e(j,{class:"q-my-xs"}),B((m(),h(R,{onClick:c[1]||(c[1]=l=>w(b.row)),clickable:"",class:"text-red-600 dark:text-red-400 rounded-md"},{default:t(()=>[e(U,null,{default:t(()=>[e(M,{class:"flex-nowrap"},{default:t(()=>[e(C,{name:"sym_r_delete",size:"xs",class:"me-1"}),y(" "+o(d.$t("delete")),1)]),_:1})]),_:1})]),_:1})),[[L]])]),_:1})]),_:1})]),_:1}))}},ye={class:"bg-primary-50 flex justify-center items-center w-fit p-3 rounded-full"},he={class:"text-h6 text-center mb-4"},be={class:"grid grid-cols-2 justify-between mt-5"},ge={class:"text-subtitle2"},we={class:"text-gray-700 dark:text-gray-400 text-end",style:{"font-family":"monospace, sans-serif","word-break":"break-all","white-space":"normal"}},ve={class:"grid grid-cols-2 justify-between mt-3"},ke={class:"text-subtitle2"},xe={class:"text-gray-700 dark:text-gray-400 text-end"},$e={class:"text-sm"},Qe={class:"text-primary"},Ce={class:"mt-5"},De={class:"grid grid-cols-2 justify-between items-center"},Se={class:"p-2 w-fit rounded-md bg-primary-50"},je={key:0,class:"text-sm font-medium"},qe={key:1,class:"text-sm font-medium"},Ve={class:"w-fit"},ze={__name:"ShowDetailsView",props:{id:{type:[String,Number]}},setup(b){const g=b,{data:n,fetch:w,loading:p}=pe("admin/ssh-keys"),{truncate:d}=A(),c=q(()=>n.value.servers?n.value.servers.map(l=>({id:l.id,instance_id:d(l.instance_id,25),status:{label:l.status.label,color:l.status.color}})):[]);return te(()=>g.id,l=>{l&&w(l)}),(l,V)=>{const u=se("router-link");return m(),h(_e,{title:"ssh_keys.ssh_key_details",loading:r(p)},{content:t(()=>[e(I,{class:"shadow-none bg-transparent"},{default:t(()=>[e($,{class:"p-0 flex justify-center items-center"},{default:t(()=>[a("div",ye,[e(C,{name:"sym_r_key",size:"xl",color:"primary"})])]),_:1}),e($,{class:"q-pa-md"},{default:t(()=>[a("div",he,o(r(n)?.name),1),a("div",be,[a("div",ge,o(l.$t("ssh_keys.public_key")),1),a("div",we,o(r(n)?.public_key)+"***** ",1)]),e(j,{class:"mt-2"}),a("div",ve,[a("div",ke,o(l.$t("creation_details")),1),a("div",xe,[y(o(r(n)?.created_at)+" ",1),a("div",$e,[y(o(l.$t("by"))+": ",1),a("span",Qe,o(r(n)?.created_by?.name),1)])])]),c.value&&c.value.length?(m(),Q(N,{key:0},[e(j,{class:"mt-2"}),a("div",Ce,o(l.$t("assigned_servers")),1),a("div",De,[(m(!0),Q(N,null,le(c.value,_=>(m(),h(u,{key:_.id,to:{name:"admin.servers.show",params:{id:_.id}}},{default:t(()=>[e(I,{class:"w-full flex flex-nowrap gap-2 items-center p-3 border mt-3"},{default:t(()=>[e($,{class:"p-0"},{default:t(()=>[a("div",Se,[e(C,{name:"sym_r_host",size:"sm",class:"text-primary"})])]),_:1}),e($,{class:"p-0"},{default:t(()=>[_.instance_id&&_.instance_id!==null?(m(),Q("div",je,o(_.instance_id),1)):(m(),Q("div",qe," N/A ")),a("div",Ve,[e(ue,{"text-color":_.status.color,size:"xs",class:"q-mt-xs"},{default:t(()=>[y(o(_.status.label),1)]),_:2},1032,["text-color"])])]),_:2},1024)]),_:2},1024)]),_:2},1032,["to"]))),128))])],64)):ae("",!0)]),_:1})]),_:1})]),_:1},8,["loading"])}}},Te={class:"mt-4 bg-white dark:bg-slate-800 p-3 rounded-md"},Be={class:"flex items-center justify-between gap-3 mb-3"},Ie={class:"break-all",style:{"font-family":"monospace, sans-serif"}},Ne={class:"block"},Re={class:"font-medium"},at={__name:"IndexView",setup(b){const{data:g,fetch:n,loading:w,options:p,onRequest:d}=ie("admin/ssh-keys"),{destroy:c,destroyed:l,destroying:V}=re("admin/ssh-keys"),{t:u}=oe(),_=q(()=>[{name:"id",label:u("id"),field:"id",sortable:!0,align:"left"},{name:"name",label:u("name"),field:"name",sortable:!0,align:"left"},{name:"public_key",label:u("ssh_keys.public_key"),field:"public_key",align:"left"},{name:"servers_count",label:u("assigned_servers"),field:"servers_count",align:"center"},{name:"created_at",label:u("creation_details"),sortable:!0,field:"created_at",align:"left"},{name:"actions",label:u("actions"),field:"actions",align:"center"}]),F=q(()=>[{name:"created_at",label:u("creation_date"),type:"date"}]),{truncate:K}=A(),x=k(""),v=k(!1),D=k(!1),z=k(null),T=k(null),P=({search:f,filters:i})=>{n({search:f,filters:i})},E=()=>{d({filter:x.value})},O=f=>{T.value=f,D.value=!0},G=f=>{v.value=!0,z.value=f},H=async()=>{await c(z.value.id),l.value&&J()},J=()=>{v.value=!1,n({filter:x.value,filters:p.filters})};return(f,i)=>(m(),h(Z,{class:"q-pa-md"},{default:t(()=>[e(ze,{open:D.value,"onUpdate:open":i[0]||(i[0]=s=>D.value=s),id:T.value?.id},null,8,["open","id"]),e(de,{open:v.value,"onUpdate:open":i[1]||(i[1]=s=>v.value=s),title:"ssh_keys.delete",icon:"warning",color:"negative",loading:r(V),onConfirm:H,onCancel:i[2]||(i[2]=s=>v.value=!1)},null,8,["open","loading"]),e(ne,{title:"ssh_keys.title",subtitle:"ssh_keys.admin_subtitle",icon:"key"}),a("div",Te,[a("div",Be,[e(W,{onSearch:E,searchValue:x.value,"onUpdate:searchValue":i[3]||(i[3]=s=>x.value=s),class:"md:max-w-sm max-w-full"},null,8,["searchValue"]),e(X,{filters:F.value,onUpdate:P},null,8,["filters"])]),e(Y,{columns:_.value,rows:r(g)??[],loading:r(w),pagination:r(p).pagination,"onUpdate:pagination":i[4]||(i[4]=s=>r(p).pagination=s),onRequest:r(d),flat:"","rows-per-page-options":[5,10,20,30,40,50,100]},{"body-cell-public_key":t(s=>[e(S,{props:s},{default:t(()=>[a("span",Ie,o(s.row.public_key)+"*****",1)]),_:2},1032,["props"])]),"body-cell-created_at":t(s=>[e(S,{props:s,title:s.row.created_by?.name},{default:t(()=>[y(o(s.row.created_at)+" ",1),a("small",Ne,[y(o(f.$t("by"))+": ",1),a("span",Re,o(r(K)(s.row.created_by?.name,20)),1)])]),_:2},1032,["props","title"])]),"body-cell-actions":t(s=>[e(S,{props:s},{default:t(()=>[e(fe,{row:s.row,onShowDetails:O,onDelete:G},null,8,["row"])]),_:2},1032,["props"])]),_:1},8,["columns","rows","loading","pagination","onRequest"])])]),_:1}))}};export{at as default};
